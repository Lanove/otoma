var deviceBelonging=$("#bigdevicebox");function retractSidebar(){$(".sidebarCollapse .close").removeClass("active"),$(".sidebarCollapse .open").addClass("active"),$("#sidebar").removeClass("active"),$(".overlay").removeClass("active")}function requestAJAX(a,e,t=function(){},n=0,o=function(){}){var i=JSON.stringify(e);$.ajax({type:"POST",url:"api/"+a+".php",contentType:"application/json; charset=utf-8",data:i,timeout:n,success:function(a){t(a)},error:function(a,e,t){0!=n&&("timeout"==e?o(e):bootbox.alert({size:"large",title:"Gagal terhubung ke server!",message:`Sepertinya anda tidak mempunyai koneksi ke internet<br>${t}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}}))}})}function getMeta(a){const e=document.getElementsByTagName("meta");for(let t=0;t<e.length;t++)if(e[t].getAttribute("name")===a)return e[t].getAttribute("content");return""}function tabletListener(a){a.matches&&($("#dashboard .navbar").css("padding","0.5rem 1rem"),$("#dashboard .nexustcon .switch-field label").css("padding","8px 16px"),$("#dashboard #ultraM label").css("padding","8px 16px"),$("#dashboard .numin").css("max-width","180px"),null!=nexusChart&&null!=nexusChart&&nexusChart.setOption({toolbox:{itemGap:10,itemSize:25,orient:"horizontal"},title:{textStyle:{fontSize:18}}}))}function mobileListener(a){a.matches&&($("#dashboard .navbar").css("padding","0.5rem 1rem"),$("#dashboard .nexustcon .switch-field label").css("padding","8px 16px"),$("#dashboard #ultraM label").css("padding","8px 16px"),$("#dashboard .numin").css("max-width","180px"),null!=nexusChart&&null!=nexusChart&&nexusChart.setOption({title:{textStyle:{fontSize:14}},toolbox:{itemGap:6,itemSize:16,orient:"horizontal"}}))}function ultraMobileListener(a){a.matches&&($("#dashboard .navbar").css("padding","0"),$("#dashboard .nexustcon .switch-field label").css("padding","8px 10px"),$("#dashboard #ultraM label").css("padding","8px 6px"),$("#dashboard .numin").css("max-width","140px"),null!=nexusChart&&null!=nexusChart&&nexusChart.setOption({title:{textStyle:{fontSize:14}},toolbox:{itemGap:4,itemSize:16,orient:"vertical"}}))}function pageChanger(){var a=this.id,e=null;$(".absolute-overlay").removeClass("loaded"),$("#content").html("");var t="";"contactUs"==a?t="pagecon/contact-us.php":"goHelp"==a?t="pagecon/help-page.php":"goAccount"==a?t="pagecon/account-setting.php":$(this).hasClass("popidvshys")||$(this).hasClass("popidinfo")||$(this).hasClass("pohysinfo")?(a="goHelp",t="pagecon/help-page.php",e=$(this).hasClass("popidvshys")?"popidvshys":$(this).hasClass("popidinfo")?"popidinfo":$(this).hasClass("pohysinfo")?"pohysinfo":null):"progHelp"==a&&(e="progHelp",a="goHelp",t="pagecon/help-page.php"),$("#content").load(t,function(t,n,o){"success"==n&&("contactUs"==a?($("#submitContact").click(function(){""!=$("#nameContact").val()&&""!=$("#phoneContact").val()&&""!=$("#emailContact").val()&&""!=$("#messageContact").val()?($("#notifContact").text("Mengirimkan pesan anda..."),requestAJAX("GlobalService",{requestType:"submitMessage",token:getMeta("token"),name:$("#nameContact").val(),phone:$("#phoneContact").val(),email:$("#emailContact").val(),message:$("#messageContact").val()},function(a){$("#nameContact").val(""),$("#phoneContact").val(""),$("#emailContact").val(""),$("#messageContact").val(""),$("#notifContact").text("Pesan terkirim!")},5e3,function(a){bootbox.alert({size:"large",title:"Gagal mengirim pesan",message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})})):$("#notifContact").text("Gagal mengirim pesan, terdapat form isian yang belum di isi"),setTimeout(function(){$("#notifContact").text("")},15e3)}),$("#xEr").popover(),$("#xeR").popover(),$(".absolute-overlay").addClass("loaded")):"goAccount"==a?(requestAJAX("GlobalService",{requestType:"requestEmail",token:getMeta("token")},function(a){$("#ACemail").val(a)},8e3,function(a){bootbox.alert({size:"large",title:"Gagal memuat laman",message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})}),$("#ACpasswordSubmit").click(function(){$("#ACpasswordNotif").removeClass(),$("#ACpasswordNotif").text("Memproses permintaan anda..."),requestAJAX("GlobalService",{requestType:"passwordChange",token:getMeta("token"),oldPw:$("#ACpasswordLama").val(),newPw:$("#ACpasswordBaru").val(),confPw:$("#ACconfirmBaru").val()},function(a){const e=JSON.parse(a);"failure"==e.status?$("#ACpasswordNotif").addClass("tfailed"):"success"==e.status&&$("#ACpasswordNotif").addClass("tsucceed2"),$("#ACpasswordNotif").text(e.message)},4e3,function(a){bootbox.alert({size:"large",title:"Gagal mengganti password",message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})}),setTimeout(function(){$("#ACpasswordNotif").text("")},15e3)}),$("#ACdelete").click(function(){bootbox.prompt({message:"Aksi ini tidak dapat dipulihkan. Seluruh informasi yang terhubung dengan akun ini akan terhapus seluruhnya. Mohon masukkan password anda dengan benar apabila anda yakin.",title:"Apakah anda yakin ingin menghapus akun ini?",inputType:"password",buttons:{cancel:{label:'<i class="fa fa-times"></i> Tidak',className:"btn-secondary"},confirm:{label:'<i class="fa fa-check"></i> Ya',className:"btn-danger"}},callback:function(a){null!=a&&requestAJAX("GlobalService",{requestType:"deleteAccount",token:getMeta("token"),password:a},function(a){const e=JSON.parse(a);bootbox.alert({size:"large",title:e.title,message:e.message,closeButton:!1,buttons:{ok:{label:"Tutup"}}}),"success"==e.status&&setTimeout(function(){window.location.replace("logout.php")},3e3)},4e3,function(a){bootbox.alert({size:"large",title:"Terjadi kesalahan",message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})})}})}),$("#ACemailSubmit").click(function(){$("#ACemailNotif").removeClass(),$("#ACemailNotif").text("Memproses permintaan anda..."),requestAJAX("GlobalService",{requestType:"emailChange",token:getMeta("token"),email:$("#ACemail").val()},function(a){const e=JSON.parse(a);"failure"==e.status?$("#ACemailNotif").addClass("tfailed"):"success"==e.status&&$("#ACemailNotif").addClass("tsucceed2"),$("#ACemailNotif").text(e.message)},4e3,function(a){bootbox.alert({size:"large",title:"Gagal mengganti email",message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})}),setTimeout(function(){$("#ACemailNotif").text("")},15e3)}),$(".absolute-overlay").addClass("loaded")):"goHelp"==a&&($("#main-accordion").accordiom({autoClosing:!1,showFirstItem:!1,onLoad:function(a){$(".absolute-overlay").addClass("loaded")},beforeChange:function(){const a=$(this).is(".on");$(this).find(".caret").animateRotate(180*a,180*a+180,500)},afterchange:function(){}}),$("#sub-accordion1, #sub-accordion2, #sub-accordion3").accordiom({autoClosing:!1,showFirstItem:!1,beforeChange:function(){const a=$(this).is(".on");$(this).find(".caret").animateRotate(180*a,180*a+180,500)},onLoad:function(a){}})),null!=e&&("popidvshys"==e?($().accordiom.openItem("#main-accordion",1),$().accordiom.openItem("#sub-accordion2",0)):"popidinfo"==e?($().accordiom.openItem("#main-accordion",1),$().accordiom.openItem("#sub-accordion2",1)):"pohysinfo"==e?($().accordiom.openItem("#main-accordion",1),$().accordiom.openItem("#sub-accordion2",2)):"progHelp"==e&&$().accordiom.openItem("#main-accordion",2)),retractSidebar()),"error"==status&&bootbox.alert({size:"large",title:"Gagal memuat laman",message:"Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian.",closeButton:!1,buttons:{ok:{label:"Tutup"}}})})}if($.fn.animateRotate=function(a,e,t,n,o){var i=$.speed(t,n,o),s=i.step;return this.each(function(t,n){i.complete=$.proxy(i.complete,n),i.step=function(a){if($.style(n,"transform","rotate("+a+"deg)"),s)return s.apply(n,arguments)},$({deg:a}).animate({deg:e},i)})},$(window).on("resize",function(){if(null!=nexusChart&&null!=nexusChart){const a=window.matchMedia("screen and (max-width: 380px)"),e=window.matchMedia("screen and (min-width: 381px) and (max-width: 611px)"),t=window.matchMedia("screen and (min-width: 612px)");ultraMobileListener(a),mobileListener(e),tabletListener(t),nexusChart.resize()}}),$(document).ready(function(){const a=window.matchMedia("screen and (max-width: 380px)"),e=window.matchMedia("screen and (min-width: 381px) and (max-width: 611px)"),t=window.matchMedia("screen and (min-width: 612px)");ultraMobileListener(a),mobileListener(e),tabletListener(t),a.addListener(ultraMobileListener),e.addListener(mobileListener),t.addListener(tabletListener),deviceBelonging.length||$(".absolute-overlay").addClass("loaded"),$(document).on("click","#contactUs, #goHelp, #goAccount, #progHelp",pageChanger),$("#otomaIcon, #goHome").on("click",function(){deviceBelonging.length?deviceBelonging.hasClass("nexusdevice")&&!$("#nexus-dashboard").length?(retractSidebar(),$(".absolute-overlay").removeClass("loaded"),$("#content").html(""),$("#content").load("pagecon/nexus-device.php",function(a,e,t){"success"==e&&(nexusFirstLoad(getBondKey()),$(".absolute-overlay").addClass("loaded")),"error"==status&&bootbox.alert({size:"large",title:"Gagal memuat laman",message:"Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian",closeButton:!1,buttons:{ok:{label:"Tutup"}}})})):retractSidebar():location.reload()}),$("#sidebar").mCustomScrollbar({theme:"minimal"}),$("#dismiss, .overlay").on("click",function(){retractSidebar()}),$(".sidebarCollapse").on("click",function(){1==$(".sidebarCollapse .open").hasClass("active")?($(".sidebarCollapse .open").removeClass("active"),$(".sidebarCollapse .close").addClass("active"),$("#sidebar").addClass("active"),$(".overlay").addClass("active"),$(".collapse.in").toggleClass("in"),$("a[aria-expanded=true]").attr("aria-expanded","false")):retractSidebar()})}),deviceBelonging){function createDataSource(a,e){var t,n;for(t=0;t<e.length;t++){var o=e[t],i=[];for(n=0;n<o+1;n++)i.push({val:n.toString(),label:n.toString()});a.push(i)}}function updateBar(a,e,t){var n=document.getElementById(a);n.style.width=e+"%",n.innerHTML=t}function convertToDateLong(a){var e=a.split("-");let t=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"][parseInt(e[1])-1];return e[2]+" "+t+" "+e[0]}function getBondKey(){return $("#bondContainer").val()}function setBondKey(a){$("#bondContainer").val(a)}function downloadCSV(a,e){var t,n;t=new Blob([a],{type:"text/csv"}),(n=document.createElement("a")).download=e,n.href=window.URL.createObjectURL(t),n.style.display="none",document.body.appendChild(n),n.click()}function exportTableToCSV(a,e){for(var t=[],n=$("#"+a).find("tr"),o=0;o<n.length;o++){for(var i=[],s=n[o].querySelectorAll("td, th"),l=0;l<s.length;l++)i.push(s[l].innerText);t.push(i.join(","))}downloadCSV(t.join("\n"),e+".csv")}function exportTableToExcel(a,e=""){var t;var n=document.getElementById(a).outerHTML.replace(/ /g,"%20");if(e=e?e+".xls":"excel_data.xls",t=document.createElement("a"),document.body.appendChild(t),navigator.msSaveOrOpenBlob){var o=new Blob(["\ufeff",n],{type:"application/vnd.ms-excel"});navigator.msSaveOrOpenBlob(o,e)}else t.href="data:application/vnd.ms-excel, "+n,t.download=e,t.click()}if(deviceBelonging.hasClass("maindevice"));else if(deviceBelonging.hasClass("nexusdevice")){var nexusChart,config={color:["#b8002b","#002bb8","#00b82b","#2b00b8"],tooltip:{trigger:"axis",position:function(a,e,t,n,o){return a[0]<o.viewSize[0]/2?[a[0],"-10%"]:[a[0]-130,"-10%"]},axisPointer:{type:"line",lineStyle:{color:"#fff"}}},grid:{left:40,top:50,right:10,bottom:25,borderColor:"#ccc"},title:{text:"sampletext",left:"center",textStyle:{color:"#ffffff",fontFamily:'"Poppins", sans-serif',fontWeight:"normal",fontSize:18}},textStyle:{color:"#ffffff",fontFamily:'"Poppins", sans-serif',fontSize:16},toolbox:{orient:"horizontal",right:-5,itemSize:25,showTitle:!1,iconStyle:{color:"#132e32"},textStyle:{color:"#fff"},feature:{dataZoom:{yAxisIndex:"none",icon:{zoom:"path://M304 192v32c0 6.6-5.4 12-12 12h-56v56c0 6.6-5.4 12-12 12h-32c-6.6 0-12-5.4-12-12v-56h-56c-6.6 0-12-5.4-12-12v-32c0-6.6 5.4-12 12-12h56v-56c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v56h56c6.6 0 12 5.4 12 12zm201 284.7L476.7 505c-9.4 9.4-24.6 9.4-33.9 0L343 405.3c-4.5-4.5-7-10.6-7-17V372c-35.3 27.6-79.7 44-128 44C93.1 416 0 322.9 0 208S93.1 0 208 0s208 93.1 208 208c0 48.3-16.4 92.7-44 128h16.3c6.4 0 12.5 2.5 17 7l99.7 99.7c9.3 9.4 9.3 24.6 0 34zM344 208c0-75.2-60.8-136-136-136S72 132.8 72 208s60.8 136 136 136 136-60.8 136-136z",back:"path://M304 192v32c0 6.6-5.4 12-12 12H124c-6.6 0-12-5.4-12-12v-32c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm201 284.7L476.7 505c-9.4 9.4-24.6 9.4-33.9 0L343 405.3c-4.5-4.5-7-10.6-7-17V372c-35.3 27.6-79.7 44-128 44C93.1 416 0 322.9 0 208S93.1 0 208 0s208 93.1 208 208c0 48.3-16.4 92.7-44 128h16.3c6.4 0 12.5 2.5 17 7l99.7 99.7c9.3 9.4 9.3 24.6 0 34zM344 208c0-75.2-60.8-136-136-136S72 132.8 72 208s60.8 136 136 136 136-60.8 136-136z"}},restore:{show:!1},dataView:{lang:["Data View","Close","Refresh"],optionToContent:function(a){var e=a.xAxis[0].data,t=a.series;const n=a.title[0].text;for(var o=`\n                  <div style="position: absolute;top: 5px;right: 20px;" class="dropdown">\n                    <button  data-toggle="dropdown" type="button" class="btn btn-primary">\n                      Download <i class = 'fas fa-caret-down'></i>\n                    </button>\n                    <div class="dropdown-menu">\n                      <a class="dropdown-item" href="#0" onclick="exportTableToCSV('dataview','${n}');">CSV</a>\n                      <a class="dropdown-item" href="#0" onclick="exportTableToExcel('dataview','${n}');">Excel</a>\n                    </div>\n                  </div>\n                `+'<table id="dataview" style="width:100%;text-align:center"><tbody><tr><td></td><td>Waktu:</td><td>'+t[0].name+"</td><td>"+t[1].name+"</td></tr>",i=0,s=e.length;i<s;i++)o+="<tr><td>"+(i+1)+"</td><td>"+e[i]+"</td><td>"+t[0].data[i]+"</td><td>"+t[1].data[i]+"</td></tr>";return o+="</tbody></table>"},icon:"path://M464 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM224 416H64v-96h160v96zm0-160H64v-96h160v96zm224 160H288v-96h160v96zm0-160H288v-96h160v96z"}}},legend:{data:["Suhu (°C)","Humiditas (%)"],top:25,textStyle:{color:"#ffffff",fontFamily:'"Poppins", sans-serif'}},xAxis:{type:"category",axisTick:{alignWithLabel:!0},boundaryGap:!1,axisLabel:{fontSize:12,fontFamily:'"Poppins", sans-serif'},axisLine:{lineStyle:{color:"#ffffff"}},data:["sampletext"]},yAxis:{scale:!0,type:"value",axisLabel:{fontSize:12,fontFamily:'"Poppins", sans-serif'},axisLine:{lineStyle:{color:"#e9e9e9"}}},dataZoom:[{type:"inside",start:0,end:100}],series:[{name:"Suhu (°C)",type:"line",data:[],smooth:!0,symbol:"none",sampling:"average"},{name:"Humiditas (%)",type:"line",data:[],smooth:!0,symbol:"none",sampling:"average"}]};function redrawChart(a){if(nexusChart&&nexusChart.dispose(),a.available){$("#goverlay").removeClass("active"),$("#goverlay p").text("");var e={humidData:[],tempData:[],label:[]};for(c in a.data)e.tempData[c]=parseFloat(a.data[c].data1),e.humidData[c]=parseFloat(a.data[c].data2),e.label[c]=a.data[c].timestamp.slice(0,5);config.title.text="Grafik pada "+convertToDateLong(a.plotDate),config.xAxis.data=e.label,config.series[0].data=e.tempData,config.series[1].data=e.humidData,(nexusChart=echarts.init(document.getElementById("graph"))).setOption(config);const t=window.matchMedia("screen and (max-width: 380px)"),n=window.matchMedia("screen and (min-width: 381px) and (max-width: 611px)"),o=window.matchMedia("screen and (min-width: 612px)");ultraMobileListener(t),mobileListener(n),tabletListener(o)}else $("#goverlay").addClass("active"),$("#goverlay p").text("Grafik pada "+convertToDateLong(a.plotDate)+" tidak tersedia. Hal ini disebabkan karena kontroller anda tidak online pada tanggal tersebut, pastikan kontroller anda tetap tersambung ke internet agar kontroller dapat mengirim data grafik ke database")}function formatTimerInput(a){var e=a.match(/\d+/g);for(i in e)null!==e[i]&&void 0!==e[i]&&""!==e[i]&&"0"!==e[i]||(e[i]="0");return e}function formatTimerOutput(a){var e="",t=["h ","j ","m"];for(i in a.values)null===a.values[i].val||void 0===a.values[i].val||""===a.values[i].val||"0"===a.values[i].val?e+="0"+t[i]:e+=a.values[i].val+t[i];return e}function formatSHInput(a){for(i in matches=a.match(/\d+/g),matches)null!==matches[i]&&void 0!==matches[i]&&""!==matches[i]&&"0"!==matches[i]||(matches[i]="0");return matches}function formatJadwalInput(a){var e=[];if(null==a||""===a||"0"===a)e[0]="0",e[1]="0",e[2]="0";else for(i in e=a.match(/\d+/g))null!==e[i]&&void 0!==e[i]&&""!==e[i]&&"0"!==e[i]||(e[i]="0");return e}function formatJadwalOutput(a){var e="",t=[":",":",""];for(i in a.values)null===a.values[i].val||void 0===a.values[i].val||""===a.values[i].val||"0"===a.values[i].val?e+="0"+t[i]:e+=a.values[i].val+t[i];return e}function spsetOut(a){var e="",t=[".",""];for(i in a.values)null===a.values[i].val||void 0===a.values[i].val||""===a.values[i].val||"0"===a.values[i].val?e+="0"+t[i]:e+=a.values[i].val+t[i];return"spsetting"==this.elem.id&&($("#spvalue").text(String(e)+"°C"),requestAJAX("NexusService",{token:getMeta("token"),bondKey:getBondKey(),requestType:"changeSetpoint",data:e},function(a){},3e3,function(a){bootbox.alert({size:"large",title:"Gagal mengganti setpoin suhu",message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})})),e}function createTextDataSource(a){for(var e=[],t=0;t<a.length;t++)e.push({val:a[t],label:a[t]});return e}function buildTempOrHum(a,e){$(`#condition${a} .content`).append(`\n      <div class="item ctCd">\n        <input style="max-width:50px;text-align:center;" type="text" class="form-control" id="nscmpCd${a}" value=">" readonly>\n      </div>    \n      <div class="item ctCd">\n        <input style="max-width:70px;text-align:center;" type="text" class="form-control" id="nsvalCd${a}" value="0" readonly>\n      </div>\n      <div class="item ctCd">\n          <span>Aksi</span>\n          <input style="max-width:220px;text-align:center;" type="text" class="form-control" id="acCd${a}" readonly>\n      </div>`),$("#nscmpCd"+a).unbind().removeData(),$("#nscmpCd"+a).AnyPicker({showComponentLabel:!0,mode:"select",lang:"id",components:[{component:0,name:"operator",label:"Operator",width:"50%",textAlign:"center"}],dataSource:[{component:0,data:createTextDataSource(["<",">","<=",">="])}]});var t=[];createDataSource(t,[100,9]),$("#nsvalCd"+a).unbind().removeData(),$(`#nsvalCd${a}`).AnyPicker({showComponentLabel:!0,mode:"select",lang:"id",components:[{component:0,name:"c",label:"Nilai Suhu"==e?"Suhu (°C)":"Humiditas (%)",width:"30%",textAlign:"center"},{component:1,name:"d",label:"Koma",width:"30%",textAlign:"center"}],dataSource:[{component:0,data:t[0]},{component:1,data:t[1]}],parseInput:formatSHInput,formatOutput:spsetOut})}function buildConditionalPicker(a){$(`#condition${a} .content`).append(`\n      <div class="item ctCd">\n        <span>Jika</span>\n        <input style="max-width:150px;text-align:center;" type="text" class="form-control" id="cndCd${a}" value="Output 1" readonly>\n      </div>\n      <div class="item ctCd">\n        <span>Sedang</span>\n        <input style="max-width:150px;text-align:center;" type="text" class="form-control" id="cnddCd${a}" value="Menyala" readonly>\n      </div>\n      <div class="item ctCd">\n          <span>Aksi</span>\n          <input style="max-width:220px;text-align:center;" type="text" class="form-control" id="acCd${a}" readonly>\n      </div>`),$("#cndCd"+a).unbind().removeData(),$("#cndCd"+a).AnyPicker({showComponentLabel:!0,mode:"select",lang:"id",components:[{component:0,name:"komponen",label:"Komponen",width:"50%",textAlign:"center"}],dataSource:[{component:0,data:createTextDataSource(["Output 1","Output 2","Pemanas","Pendingin","Thermocontrol"])}]}),$("#cnddCd"+a).unbind().removeData(),$("#cnddCd"+a).AnyPicker({showComponentLabel:!0,mode:"select",lang:"id",components:[{component:0,name:"kondisi",label:"Kondisi",width:"50%",textAlign:"center"}],dataSource:[{component:0,data:createTextDataSource(["Menyala","Mati"])}]})}function buildTimer(a){$(`#condition${a} .content`).append(`\n      <div class="item ctCd">\n        <span>Durasi</span>\n        <input style="max-width:125px;text-align:center;" type="text" class="form-control" id="timerCd${a}" value="0h 0j 0m" readonly>\n      </div>          \n      <div class="item ctCd">\n        <button class="btn btn-primary" style="margin-right:7.5px;" id="tstartCd${a}">Start</button>\n        <button class="btn btn-primary" class="tstopCd${a}">Reset</button>\n      </div>\n      <div class="item ctCd">\n          <span>Aksi</span>\n          <input style="max-width:220px;text-align:center;" type="text" class="form-control" id="acCd${a}" readonly>\n      </div>`);var e=[];createDataSource(e,[30,23,59]),$("#timerCd"+a).unbind().removeData(),$(`#timerCd${a}`).AnyPicker({mode:"select",lang:"id",showComponentLabel:!0,components:[{component:0,name:"h",label:"Hari",width:"40%",textAlign:"center"},{component:1,name:"j",label:"Jam",width:"30%",textAlign:"center"},{component:2,name:"m",label:"Menit",width:"30%",textAlign:"center"}],dataSource:[{component:0,data:e[0]},{component:1,data:e[1]},{component:2,data:e[2]}],parseInput:formatTimerInput,formatOutput:formatTimerOutput})}jQuery.fn.sortDivs=function(){$("> div",this[0]).sort(function(a,e){return $(e).data("sort")<$(a).data("sort")?1:-1}).appendTo(this[0])};var oAP1=[],oAP2=[];function buildDailyPicker(a){$(`#condition${a} .content`).append(`\n      <div class="item ctCd">\n        <span>Dari</span>\n        <input style="max-width:100px;text-align:center;" type="text" class="form-control" id="faCd${a}" readonly>\n      </div>    \n      <div class="item ctCd">\n        <span>Hingga</span>\n        <input style="max-width:100px;text-align:center;" type="text" class="form-control" id="feCd${a}" readonly>\n      </div>\n      <div class="item ctCd">\n          <span>Aksi</span>\n          <input style="max-width:220px;text-align:center;" type="text" class="form-control" id="acCd${a}" readonly>\n      </div>`);var e=[];createDataSource(e,[23,59,59]),$("#faCd"+a).unbind().removeData(),$(`#faCd${a}`).AnyPicker({mode:"select",lang:"id",showComponentLabel:!0,components:[{component:0,name:"j",label:"Jam",width:"33%",textAlign:"center"},{component:1,name:"m",label:"Menit",width:"33%",textAlign:"center"},{component:2,name:"d",label:"Detik",width:"33%",textAlign:"center"}],dataSource:[{component:0,data:e[0]},{component:1,data:e[1]},{component:2,data:e[2]}],parseInput:formatJadwalInput,formatOutput:formatJadwalOutput}),$("#feCd"+a).unbind().removeData(),$(`#feCd${a}`).AnyPicker({mode:"select",lang:"id",showComponentLabel:!0,components:[{component:0,name:"j",label:"Jam",width:"33%",textAlign:"center"},{component:1,name:"m",label:"Menit",width:"33%",textAlign:"center"},{component:2,name:"d",label:"Detik",width:"33%",textAlign:"center"}],dataSource:[{component:0,data:e[0]},{component:1,data:e[1]},{component:2,data:e[2]}],parseInput:formatJadwalInput,formatOutput:formatJadwalOutput})}function buildDateTimePicker(a){$(`#condition${a} .content`).append(`\n      <div class="item ctCd">\n        <span>Dari</span>\n        <input style="max-width:200px;text-align:center;" type="text" class="form-control" id="dfaCd${a}" readonly>\n      </div>    \n      <div class="item ctCd">\n        <span>Hingga</span>\n        <input style="max-width:200px;text-align:center;" type="text" class="form-control" id="dfeCd${a}" readonly>\n      </div>\n      <div class="item ctCd">\n          <span>Aksi</span>\n          <input style="max-width:220px;text-align:center;" type="text" class="form-control" id="acCd${a}" readonly>\n      </div>`),$("#dfaCd"+a).unbind().removeData(),$(`#dfaCd${a}`).AnyPicker({mode:"datetime",lang:"id",dateTimeFormat:"yyyy-MM-dd HH:mm",showComponentLabel:!0,minValue:new Date(2020,0,1),maxValue:new Date(2025,12,31)}),$("#dfeCd"+a).unbind().removeData(),$(`#dfeCd${a}`).AnyPicker({mode:"datetime",lang:"id",dateTimeFormat:"yyyy-MM-dd HH:mm",showComponentLabel:!0,minValue:new Date(2020,0,1),maxValue:new Date(2025,12,31)})}function buildActionPicker(a,e){$("#acCd"+a).unbind().removeData(),$("#acCd"+a).AnyPicker({showComponentLabel:!0,mode:"select",lang:"id",components:[{component:0,name:"aksi",label:"Aksi",width:"50%",textAlign:"center"}],dataSource:[{component:0,data:createTextDataSource(e)}]})}function appendConditionalChild(a,e){$("#conditional").append(`\n      <div class="row" data-sort="${a}">\n        <div class="col-12">\n            <div class="nexuscond" id="condition${a}">\n                <div class="numbox d-flex align-items-center justify-content-center">\n                    <span>Program ${a}</span>\n                </div>\n                <div class="d-flex content justify-content-center">\n                    <div class="item pgCd">\n                        <span>Pemicu</span>\n                        <input type="text" class="form-control" id="ifCd${a}" style="max-width:150px;text-align:center;" readonly>\n                    </div>\n                </div>\n                <span id="nSpan${a}" style="text-align:center;"></span>\n                <div class="d-flex align-items-center justify-content-center" style="padding-bottom:15px;">\n                    <button class="btn btn-primary" style="margin-right:15px;" id="submitCd${a}">Update</button>\n                    <button class="btn btn-primary" id="deleteCd${a}">Hapus</button>\n                </div>\n              </div>\n          </div>\n      </div>`),$("#conditional").sortDivs(),$("#ifCd"+a).unbind().removeData(),$(`#ifCd${a}`).AnyPicker({showComponentLabel:!0,mode:"select",lang:"id",formatOutput:pgacCdCallback,components:[{component:0,name:"pemicu",label:"Pemicu",width:"50%",textAlign:"center"}],dataSource:[{component:0,data:createTextDataSource(e)}]}),$(`#submitCd${a}, #deleteCd${a}`).unbind().removeData(),$(`#submitCd${a}, #deleteCd${a}`).click(function(){var e={},t=$(`#nSpan${a}`);if(t.html(""),"submitCd"==this.id.match(/\D+/g)){const s=$(`#ifCd${a}`).val();var n=!0;if("Nilai Suhu"==s||"Nilai Humiditas"==s)e.nscmpCd=$(`#nscmpCd${a}`).val(),e.nsvalCd=$(`#nsvalCd${a}`).val(),e.acCd=$(`#acCd${a}`).val(),""==$(`#nscmpCd${a}`).val()&&(t.append('<span class="tfailed" style="display:block;">Komparator tidak boleh kosong<span>'),n=!1),""==$(`#nsvalCd${a}`).val()&&(t.append("Nilai Suhu"==s?'<span class="tfailed" style="display:block;">Nilai Suhu tidak boleh kosong<span>':'<span class="tfailed" style="display:block;">Nilai Humiditas tidak boleh kosong<span>'),n=!1),""==$(`#acCd${a}`).val()&&(t.append('<span class="tfailed" style="display:block;">Aksi tidak boleh kosong<span>'),n=!1);else if("Jadwal Harian"==s){if(e.faCd=$(`#faCd${a}`).val(),e.feCd=$(`#feCd${a}`).val(),e.acCd=$(`#acCd${a}`).val(),""==$(`#faCd${a}`).val()&&(t.append('<span class="tfailed" style="display:block;">Input Jam (Dari) tidak boleh kosong<span>'),n=!1),""==$(`#feCd${a}`).val()&&(t.append('<span class="tfailed" style="display:block;">Input Jam (Hingga) tidak boleh kosong<span>'),n=!1),""!=e.feCd&&""!=e.faCd){const a=[e.faCd.split(":"),e.feCd.split(":")];3600*a[0][0]+60*a[0][1]+a[0][2]>3600*a[1][0]+60*a[1][1]+a[1][2]&&(t.append('<span class="tfailed" style="display:block;">Input Jam (Dari) tidak boleh melebihi dari Input Jam (Hingga)<span>'),n=!1)}""==$(`#acCd${a}`).val()&&(t.append('<span class="tfailed" style="display:block;">Aksi tidak boleh kosong<span>'),n=!1)}else if("Tanggal Waktu"==s){if(e.dfaCd=$(`#dfaCd${a}`).val(),e.dfeCd=$(`#dfeCd${a}`).val(),e.acCd=$(`#acCd${a}`).val(),""==$(`#dfaCd${a}`).val()&&(t.append('<span class="tfailed" style="display:block;">Input Tanggal Waktu (Dari) tidak boleh kosong<span>'),n=!1),""==$(`#dfeCd${a}`).val()&&(t.append('<span class="tfailed" style="display:block;">Input Tanggal Waktu (Hingga) tidak boleh kosong<span>'),n=!1),""!=$(`#dfeCd${a}`).val()&&""!=$(`#dfaCd${a}`).val()){var o=$(`#dfaCd${a}`).val().split(" "),i=$(`#dfeCd${a}`).val().split(" ");const e=Date.parse(o),s=Date.parse(i),l=new Date;e>s&&(t.append('<span class="tfailed" style="display:block;">Tanggal Waktu(Dari) tidak boleh melebihi Tanggal Waktu(Hingga)<span>'),n=!1),s<l.getTime()&&(t.append('<span class="tfailed" style="display:block;">Tidak dapat memilih Tanggal Waktu(Hingga) yang telah berlalu dari waktu sekarang<span>'),n=!1)}""==$(`#acCd${a}`).val()&&(t.append('<span class="tfailed" style="display:block;">Aksi tidak boleh kosong<span>'),n=!1)}else"Timer"==s?(e.timerCd=$(`#timerCd${a}`).val(),e.acCd=$(`#acCd${a}`).val(),""==$(`#timerCd${a}`).val()&&(t.append('<span class="tfailed" style="display:block;">Durasi timer tidak boleh kosong<span>'),n=!1),""==$(`#acCd${a}`).val()&&(t.append('<span class="tfailed" style="display:block;">Aksi tidak boleh kosong<span>'),n=!1)):"Keadaan"==s?(e.cndCd=$(`#cndCd${a}`).val(),e.cnddCd=$(`#cnddCd${a}`).val(),e.acCd=$(`#acCd${a}`).val(),""==$(`#cndCd${a}`).val()&&(t.append('<span class="tfailed" style="display:block;">Input komponen tidak boleh kosong<span>'),n=!1),""==$(`#cnddCd${a}`).val()&&(t.append('<span class="tfailed" style="display:block;">Input kondisi tidak boleh kosong<span>'),n=!1),""==$(`#acCd${a}`).val()&&(t.append('<span class="tfailed" style="display:block;">Aksi tidak boleh kosong<span>'),n=!1)):(n=!1,t.append('<span class="tfailed" style="display:block;">Pemicu tidak boleh kosong<span>'));n&&(t.append('<span style="display:block;">Mengupdate program ke database...<span>'),e.trCd=s,e.progNum=a,requestAJAX("NexusService",{token:getMeta("token"),bondKey:getBondKey(),requestType:"updateProgram",passedData:e},function(a){t.html(""),JSON.parse(a).success?t.append('<span style="display:block;" class="tsucceed2">Program berhasil terupdate ke database<span>'):t.append('<span style="display:block;" class="tfailed">Gagal mengupdate program ke database, silahkan coba lagi setelah beberapa saat<span>'),setTimeout(function(){t.html("")},3e4)},4e3,function(e){bootbox.alert({size:"large",title:`Gagal mengupdate program ${a}`,message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${e}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})}))}else t.append('<span style="display:block;">Menghapus program dari database...<span>'),e.progNum=a,requestAJAX("NexusService",{token:getMeta("token"),bondKey:getBondKey(),requestType:"deleteProgram",passedData:e},function(e){t.html(""),JSON.parse(e).success?$(`#condition${a}`).remove():t.append('<span style="display:block;" class="tfailed">Gagal menghapus, silahkan coba lagi setelah beberapa saat<span>'),setTimeout(function(){t.html("")},3e4)},5e3,function(e){bootbox.alert({size:"large",title:`Gagal menghapus program ${a}`,message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${e}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})})})}function pgacCdCallback(a){var e=a.values[0].val,t=this.elem.id,n=t.match(/\d+/g);if("ifCd"===t.substring(0,4)){var o=[];$(`#condition${n} .ctCd`).remove(),"Timer"==e?(buildTimer(n),o=["Nyalakan Output 1","Nyalakan Output 2","Nyalakan Pemanas","Nyalakan Pendingin","Matikan Pemanas","Matikan Pendingin","Nyalakan Thermocontrol"]):"Nilai Suhu"==e||"Nilai Humiditas"==e?(buildTempOrHum(n,e),o=["Nyalakan Output 1","Nyalakan Output 2","Nyalakan Pemanas","Nyalakan Pendingin","Nyalakan Thermocontrol","Matikan Output 1","Matikan Output 2","Matikan Pemanas","Matikan Pendingin","Matikan Thermocontrol"]):"Jadwal Harian"==e?(buildDailyPicker(n),o=["Nyalakan Output 1","Nyalakan Output 2","Nyalakan Pemanas","Nyalakan Pendingin","Nyalakan Thermocontrol","Matikan Output 1","Matikan Output 2","Matikan Pemanas","Matikan Pendingin","Matikan Thermocontrol"]):"Tanggal Waktu"==e?(buildDateTimePicker(n),o=["Nyalakan Output 1","Nyalakan Output 2","Nyalakan Pemanas","Nyalakan Pendingin","Nyalakan Thermocontrol","Matikan Output 1","Matikan Output 2","Matikan Pemanas","Matikan Pendingin","Matikan Thermocontrol"]):"Keadaan"==e&&(buildConditionalPicker(n),o=["Nyalakan Output 1","Nyalakan Output 2","Nyalakan Pemanas","Nyalakan Pendingin","Nyalakan Thermocontrol","Matikan Output 1","Matikan Output 2","Matikan Pemanas","Matikan Pendingin","Matikan Thermocontrol"]),buildActionPicker(n,o)}return e}function setTrigger(a){const e=a.values[0].label+"-"+a.values[1].label+"-"+a.values[2].label;return e!==$("#datebuffer").val()&&($("#graphoverlay").addClass("active"),requestAJAX("NexusService",{token:getMeta("token"),bondKey:getBondKey(),requestType:"loadPlot",date:e},function(a){redrawChart(JSON.parse(a).plot),$("#graphoverlay").removeClass("active")},8e3,function(a){$("#graphoverlay").removeClass("active"),bootbox.alert({size:"large",title:"Gagal memuat grafik",message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})})),$("#datebuffer").val(e),e}function submitPar(a){var e,t=[];e=a.replace("submit","#span");const n=$("#ckp").val(),o=$("#cki").val(),i=$("#ckd").val(),s=$("#cds").val(),l=$("#hkp").val(),r=$("#hki").val(),d=$("#hkd").val(),c=$("#hds").val(),u=$("#cba").val(),p=$("#cbb").val(),m=$("#hba").val(),b=$("#hbb").val();isNaN(parseFloat(n))||isNaN(parseFloat(o))||isNaN(parseFloat(i))||isNaN(parseFloat(s))||isNaN(parseFloat(u))||isNaN(parseFloat(p))||isNaN(parseFloat(l))||isNaN(parseFloat(r))||isNaN(parseFloat(d))||isNaN(parseFloat(c))||isNaN(parseFloat(m))||isNaN(parseFloat(b))?($(e).removeClass(),$(e).addClass("tfailed"),$(e).text("Terdapat kesalahan dalam input isian yang dimasukkan")):("submitcpid"===a?(t=[parseFloat(n),parseFloat(o),parseFloat(i),parseFloat(s)],modeCallback($("input[name='cmode']:checked").val(),"cmode")):"submitchys"===a?(t=[parseFloat(p),parseFloat(u)],modeCallback($("input[name='cmode']:checked").val(),"cmode")):"submithpid"===a?(t=[parseFloat(l),parseFloat(r),parseFloat(d),parseFloat(c)],modeCallback($("input[name='hmode']:checked").val(),"hmode")):"submithhys"===a&&(t=[parseFloat(b),parseFloat(m)],modeCallback($("input[name='hmode']:checked").val(),"hmode")),requestAJAX("NexusService",{requestType:"submitParameter",bondKey:getBondKey(),id:a,par:t,token:getMeta("token")},function(a){var t=JSON.parse(a);t.failed&&""!==e?($(e).removeClass(),$(e).addClass("tfailed"),$(e).text("Gagal mengupdate ke database, silahkan coba lagi sesaat kemudian")):($(e).removeClass(),$(e).addClass("tsucceed"),$(e).text("Sukses mengupdate ke database"),$("#hkp").val(t[0].heaterPar[0][0].toFixed(2)),$("#hki").val(t[0].heaterPar[0][1].toFixed(2)),$("#hkd").val(t[0].heaterPar[0][2].toFixed(2)),$("#hds").val(t[0].heaterPar[0][3]),$("#hbb").val(t[0].heaterPar[1][0].toFixed(2)),$("#hba").val(t[0].heaterPar[1][1].toFixed(2)),$("#ckp").val(t[0].coolerPar[0][0].toFixed(2)),$("#cki").val(t[0].coolerPar[0][1].toFixed(2)),$("#ckd").val(t[0].coolerPar[0][2].toFixed(2)),$("#cds").val(t[0].coolerPar[0][3]),$("#cbb").val(t[0].coolerPar[1][0].toFixed(2)),$("#cba").val(t[0].coolerPar[1][1].toFixed(2)))},5e3,function(e){bootbox.alert({size:"large",title:`Gagal mengupdate parameter ${"submithpid"==a||"submithhys"==a?"pemanas":"pendingin"}`,message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${e}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})})),setTimeout(function(){$(e).removeClass(),$(e).text("")},15e3)}function modeCallback(a,e,t=!0){if("cmode"===e)$("#coolerbox .hysteresismenu").removeClass("active"),$("#coolerbox .pidmenu").removeClass("active"),"pid"===a?$("#coolerbox .pidmenu").addClass("active"):$("#coolerbox .hysteresismenu").addClass("active");else if("hmode"===e)$("#heaterbox .hysteresismenu").removeClass("active"),$("#heaterbox .pidmenu").removeClass("active"),"pid"===a?$("#heaterbox .pidmenu").addClass("active"):$("#heaterbox .hysteresismenu").addClass("active");else if("thermmode"===e)"auto"===$("input[name='operation']:checked").val()&&($("#heateroverlay").removeClass("active"),$("#cooleroverlay").removeClass("active"),$("#heateroverlay p").text(""),$("#cooleroverlay p").text(""),"heat"===a?($("#cooleroverlay").addClass("active"),$("#cooleroverlay p").text("Hanya tersedia dalam mode Cooling atau Dual")):"cool"===a&&($("#heateroverlay").addClass("active"),$("#heateroverlay p").text("Hanya tersedia dalam mode Heating atau Dual")));else if("operation"===e)if($("#heateroverlay").removeClass("active"),$("#cooleroverlay").removeClass("active"),$("#setpointoverlay").removeClass("active"),$("#heateroverlay p").text(""),$("#cooleroverlay p").text(""),"manual"===a)$("#setpointoverlay").addClass("active"),$("#cooleroverlay").addClass("active"),$("#cooleroverlay p").text("Hanya tersedia dalam mode Auto"),$("#heateroverlay").addClass("active"),$("#heateroverlay p").text("Hanya tersedia dalam mode Auto");else{var n=$("input[name='thermmode']:checked").val();"heat"===n?($("#cooleroverlay").addClass("active"),$("#cooleroverlay p").text("Hanya tersedia dalam mode Cooling atau Dual")):"cool"===n&&($("#heateroverlay").addClass("active"),$("#heateroverlay p").text("Hanya tersedia dalam mode Heating atau Dual"))}t&&requestAJAX("NexusService",{requestType:"modeSwitch",bondKey:getBondKey(),mode:a,docchi:e,token:getMeta("token")},t=>{"auto"===a&&"operation"===e&&($("#heaterSwitch").prop("checked",!1),$("#coolerSwitch").prop("checked",!1))},3e3,function(a){bootbox.alert({size:"large",title:`Gagal mengubah ${"cmode"==e?"mode pendingin":"hmode"==e?"mode pemanas":"thermmode"==e?"mode thermocontrol":"operation"==e?"operasi thermocontrol":"kondisi"}`,message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})})}function binarySwitch(a,e){$("#aux1Switch").prop("checked",Boolean(Number(a.auxStatus1))),$("#aux2Switch").prop("checked",Boolean(Number(a.auxStatus2))),$("#thSwitch").prop("checked",Boolean(Number(a.thStatus))),$("#thSwitch").prop("checked")?$("#thOverlay").removeClass("active"):$("#thSwitch").prop("checked")||$("#thOverlay").addClass("active"),$("#heaterSwitch").prop("checked",Boolean(Number(a.htStatus))),$("#coolerSwitch").prop("checked",Boolean(Number(a.clStatus))),$("input[name=operation][value='"+a.thercoInfo[0]+"']").prop("checked",!0),$("input[name=thermmode][value='"+a.thercoInfo[1]+"']").prop("checked",!0),modeCallback($("input[name='operation']:checked").val(),"operation",!1),modeCallback($("input[name='thermmode']:checked").val(),"thermmode",!1)}function parameterReload(a,e=!1){a.thercoInfo=a.thercoInfo.split("%"),a.heaterPar=a.heaterPar.split("%"),a.coolerPar=a.coolerPar.split("%");for(var t=0;t<2;t++)a.heaterPar[t]=a.heaterPar[t].split("/"),a.coolerPar[t]=a.coolerPar[t].split("/");1==a.espStatusUpdateAvailable&&binarySwitch(a,e),$("#tempnow").text(a.tempNow+"°C"),$("#humidnow").text(a.humidNow+"%"),$("#spvalue").text(a.sp+"°C"),$("#spsetting").val(a.sp),e&&($("input[name=hmode][value='"+a.heaterMode+"']").prop("checked",!0),$("input[name=cmode][value='"+a.coolerMode+"']").prop("checked",!0),modeCallback($("input[name='hmode']:checked").val(),"hmode",!1),modeCallback($("input[name='cmode']:checked").val(),"cmode",!1),$("#ckp").val(parseFloat(a.coolerPar[0][0]).toFixed(2)),$("#cki").val(parseFloat(a.coolerPar[0][1]).toFixed(2)),$("#ckd").val(parseFloat(a.coolerPar[0][2]).toFixed(2)),$("#cds").val(a.coolerPar[0][3]),$("#cba").val(parseFloat(a.coolerPar[1][1]).toFixed(2)),$("#cbb").val(parseFloat(a.coolerPar[1][0]).toFixed(2)),$("#hkp").val(parseFloat(a.heaterPar[0][0]).toFixed(2)),$("#hki").val(parseFloat(a.heaterPar[0][1]).toFixed(2)),$("#hkd").val(parseFloat(a.heaterPar[0][2]).toFixed(2)),$("#hds").val(a.heaterPar[0][3]),$("#hba").val(parseFloat(a.heaterPar[1][1]).toFixed(2)),$("#hbb").val(parseFloat(a.heaterPar[1][0]).toFixed(2)),binarySwitch(a,e))}function reloadStatus(){requestAJAX("NexusService",{requestType:"reloadStatus",bondKey:getBondKey(),token:getMeta("token")},function(a){parameterReload(JSON.parse(a).status)})}function loadDeviceInformation(a){requestAJAX("NexusService",a,function(a){var e=JSON.parse(a);if(setBondKey(e.deviceInfo.bondKey),e.otherName)for(x in $("#deviceheader .text").text(e.deviceInfo.masterName),$("#deviceheader .text").append("<i class = 'fas fa-caret-down'></i>"),$("#deviceheader .dropdown-menu").html(""),e.otherName)$("#deviceheader .dropdown-menu").append('<a href="#" class="dropdown-item subMasterName'+String(x)+'">'+e.otherName[x].masterName+"</a>"),$(".subMasterName"+String(x)).unbind().removeData(),$(".subMasterName"+String(x)).on("click",function(){setBondKey(""),$(".absolute-overlay").removeClass("loaded"),loadDeviceInformation({requestType:"loadDeviceInformation",master:$("."+$(this).attr("class").split(/\s+/)[1]).text(),token:getMeta("token")});const a=setInterval(function(){""!=getBondKey()&&($(".absolute-overlay").addClass("loaded"),clearInterval(a))},100)});else $("#deviceheader .dropdown").html(""),$("#deviceheader .dropdown").prepend("<p class='text'>"+e.deviceInfo.masterName+"</p>");$("#auxname1").text(e.nexusBond.auxName1+" (1)"),$("#auxname2").text(e.nexusBond.auxName2+" (2)"),parameterReload(e.nexusBond,!0);var t=new Date,n=String(t.getDate()).padStart(2,"0"),o=String(t.getMonth()+1).padStart(2,"0"),i=t.getFullYear();t=i+"-"+o+"-"+n,null==e.plot.oldest.oldestPlot&&(e.plot.oldest.oldestPlot=t),null==e.plot.oldest.newestPlot&&(e.plot.newest.newestPlot=t);var s=e.plot.oldest.oldestPlot.split("-"),l=e.plot.newest.newestPlot.split("-");for(index in l)l[index]=parseInt(l[index]),s[index]=parseInt(s[index]);for(index in s[1]--,$("#dateselector").unbind().removeData(),$("#dateselector").AnyPicker({showComponentLabel:!0,mode:"datetime",dateTimeFormat:"yyyy-MM-dd",lang:"id",formatOutput:setTrigger,minValue:new Date(s[0],s[1],1),maxValue:new Date(l[0],l[1],0)}),redrawChart(e.plot),(new Date).getTime()/1e3-new Date(e.nexusBond.lastUpdate).getTime()/1e3>=300&&(e.nexusBond.lastUpdate=e.nexusBond.lastUpdate.split(" "),setTimeout(function(){bootbox.alert({size:"large",title:"Pemberitahuan",message:`Kontroller anda dengan nama <b>${e.deviceInfo.masterName}</b> sudah tidak mengirim respon ke server selama lebih dari 5 menit, <b>pastikan kontroller anda menyambung ke internet</b> agar anda dapat mengkontrol atau mengupdate kontroller.<br>Kontroller anda terakhir online pada<b> ${convertToDateLong(e.nexusBond.lastUpdate[0])} ${e.nexusBond.lastUpdate[1]}</b>`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})},2e3)),$("#conditional").html(""),e.programs){const a=e.programs[index].progNumber,t=e.programs[index].progData1,n=e.programs[index].progData2;appendConditionalChild(a,["Nilai Suhu","Nilai Humiditas","Jadwal Harian","Tanggal Waktu","Keadaan"]),$(`#ifCd${a}`).val(t),"Nilai Suhu"==t||"Nilai Humiditas"==t?(buildTempOrHum(a,t),$(`#nscmpCd${a}`).val(e.programs[index].progData3),$(`#nsvalCd${a}`).val(e.programs[index].progData4)):"Jadwal Harian"==t?(buildDailyPicker(a),$(`#faCd${a}`).val(e.programs[index].progData3),$(`#feCd${a}`).val(e.programs[index].progData4)):"Tanggal Waktu"==t?(buildDateTimePicker(a),$(`#dfaCd${a}`).val(e.programs[index].progData3),$(`#dfeCd${a}`).val(e.programs[index].progData4)):"Timer"==t?(buildTimer(a),$(`#timerCd${a}`).val(e.programs[index].progData3)):"Keadaan"==t&&(buildConditionalPicker(a),$(`#cndCd${a}`).val(e.programs[index].progData3),$(`#cnddCd${a}`).val(e.programs[index].progData4));buildActionPicker(a,"timer"!=t?["Nyalakan Output 1","Nyalakan Output 2","Nyalakan Pemanas","Nyalakan Pendingin","Nyalakan Thermocontrol","Matikan Output 1","Matikan Output 2","Matikan Pemanas","Matikan Pendingin","Matikan Thermocontrol"]:["Nyalakan Output 1","Nyalakan Output 2","Nyalakan Pemanas","Nyalakan Pendingin","Matikan Pemanas","Matikan Pendingin","Nyalakan Thermocontrol"]),$(`#acCd${a}`).val(n)}},1e4,function(a){bootbox.alert({size:"large",title:"Gagal memuat laman",message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})})}function nexusSettingLoad(){$("#delDevice").unbind().removeData(),$("#delDevice").click(function(){bootbox.prompt({message:`Aksi ini tidak dapat dipulihkan. Seluruh informasi kontroller yang terhubung dengan akun ini akan terhapus seluruhnya.<br> Tolong ketikkkan nama kontroller anda (<b>${$("#deviceName").text()}</b>) apabila anda yakin.`,title:"Apakah anda yakin ingin menghapus kontroller ini?",inputType:"text",buttons:{cancel:{label:'<i class="fa fa-times"></i> Tidak',className:"btn-secondary"},confirm:{label:'<i class="fa fa-check"></i> Ya',className:"btn-danger"}},callback:function(a){null!=a&&(a==$("#deviceName").text()?requestAJAX("NexusService",{requestType:"deleteController",bondKey:getBondKey(),token:getMeta("token")},function(a){a&&(bootbox.alert({size:"large",title:"Berhasil menghapus",message:"Kontroller sudah terhapus dari akun ini, merefresh halaman dalam 3 detik...",closeButton:!1,buttons:{ok:{label:"Tutup"}}}),setTimeout(function(){location.reload()},3e3))},5e3,function(a){bootbox.alert({size:"large",title:"Terjadi kesalahan",message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})}):bootbox.alert({size:"large",title:"Gagal menghapus kontroller",message:`Isian yang anda isi tidak sama dengan nama kontroller anda (<b>${$("#deviceName").text()}</b>).`,closeButton:!1,buttons:{ok:{label:"Tutup"}}}))}})}),$("#restartDev, #conCheck").unbind().removeData(),$("#restartDev, #conCheck").click(function(){var a,e,t;"restartDev"==this.id?(e="Restart kontroller?",a='Apabila anda yakin ingin merestart kontroller maka klik tombol "Ya"',t="restart"):"conCheck"==this.id&&(e="Putuskan koneksi internet kontroller?",a='Apabila anda yakin ingin memutus koneksi internet kontroller maka klik tombol "Ya"',t="fallback"),bootbox.confirm({title:e,className:"bootBoxPop",message:a,buttons:{cancel:{label:'<i class="fa fa-times"></i> Tidak',className:"btn-secondary"},confirm:{label:'<i class="fa fa-check"></i> Ya',className:"btn-danger"}},callback:function(a){a&&requestAJAX("NexusService",{requestType:"controllerCommand",command:t,bondKey:getBondKey(),token:getMeta("token")},function(a){},5e3,function(a){bootbox.alert({size:"large",title:"Terjadi kesalahan",message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})})}})}),$("#auxNameSubmit").unbind().removeData(),$("#auxNameSubmit").click(function(){$("#infoAuxName").removeClass(),$("#infoAuxName").text("Mengupdate ke database..."),requestAJAX("NexusService",{requestType:"updateName",docchi:"aux",name:[$("#aux1Name").val(),$("#aux2Name").val()],bondKey:getBondKey(),token:getMeta("token")},function(a){$("#infoAuxName").addClass("tsucceed2"),$("#infoAuxName").text("Sukses mengupdate"),setTimeout(function(){$("#infoAuxName").removeClass(),$("#infoAuxName").text("")},15e3)},4e3,function(a){bootbox.alert({size:"large",title:"Terjadi kesalahan",message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})})}),$("#submitEdit").unbind().removeData(),$("#submitEdit").click(function(){$("#infoName").removeClass(),$("#deviceNameEdit").val()!=$("#deviceName").text()?($("#infoName").text("Mengupdate ke database..."),requestAJAX("NexusService",{requestType:"updateName",docchi:"master",name:$("#deviceNameEdit").val(),bondKey:getBondKey(),token:getMeta("token")},function(a){0==JSON.parse(a).duplicate?($("#deviceName").text($("#deviceNameEdit").val()),$("#infoName").addClass("tsucceed2"),$("#infoName").text("Sukses mengupdate")):($("#infoName").addClass("tfailed"),$("#infoName").text("Gagal mengubah nama, nama ini sudah terambil oleh kontroller lain yang anda miliki"))},4e3,function(a){bootbox.alert({size:"large",title:"Terjadi kesalahan",message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})})):($("#infoName").addClass("tfailed"),$("#infoName").text("Gagal mengubah nama, nama yang diupdate sama dengan nama lama")),setTimeout(function(){$("#infoName").removeClass(),$("#infoName").text("")},15e3)}),requestAJAX("NexusService",{requestType:"loadSetting",bondKey:getBondKey(),token:getMeta("token")},function(a){const e=JSON.parse(a);$("#deviceName").text(e.masterName),$("#firmware").val(e.softwareVersion),$("#macaddr").val(e.MAC),$("#softSSID").val(e.softSSID),$("#softPW").val(e.softPass),$("#softIP").val(e.softIP),$("#aux1Name").val(e.auxName1),$("#aux2Name").val(e.auxName2),$("#deviceNameEdit").val(e.masterName)},8e3,function(a){bootbox.alert({size:"large",title:"Terjadi kesalahan",message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${a}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})})}function nexusFirstLoad(a=null){loadDeviceInformation(null==a?{requestType:"loadDeviceInformation",master:"master",token:getMeta("token")}:{requestType:"loadDeviceInformation",bondKey:a,token:getMeta("token")}),$("#ckp, #cki, #ckd, #hkp, #hki, #hkd, #cba, #cbb, #hba, #hbb").unbind().removeData(),$("#hds, #cds").unbind().removeData(),$("#hds, #cds").on("input",function(){var a=parseFloat(this.value);isNaN(a)?this.value="":(a>1e6?a=1e6:a<0&&(a=0),this.value=a.toFixed(0))});var e=new Date,t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),o=e.getFullYear();e=o+"-"+n+"-"+t,$("#dateselector,#datebuffer").val(e);var i=[];createDataSource(i,[100,9]),$("#spsetting").unbind().removeData(),$("#spsetting").AnyPicker({mode:"select",lang:"id",showComponentLabel:!0,components:[{component:0,name:"c",label:"Suhu (°C)",width:"30%",textAlign:"center"},{component:1,name:"d",label:"Koma",width:"30%",textAlign:"center"}],dataSource:[{component:0,data:i[0]},{component:1,data:i[1]}],parseInput:formatSHInput,formatOutput:spsetOut}),$("#coolerSwitch, #heaterSwitch, #aux1Switch, #aux2Switch, #thSwitch").unbind().removeData(),$("#coolerSwitch, #heaterSwitch, #aux1Switch, #aux2Switch, #thSwitch").click(function(){const a=$(this);var e=a.prop("checked");const t=function(t){requestAJAX("NexusService",{requestType:"toggleSwitch",bondKey:getBondKey(),id:t.id,status:String(t.checked),token:getMeta("token")},function(a){},3e3,function(n){a.prop("checked",!e),bootbox.alert({size:"large",title:`Gagal mengubah kondisi saklar ${"coolerSwitch"==t.id?"pendingin":"heaterSwitch"==t.id?"pemanas":"aux1Switch"==t.id?$("#auxname1").text():"aux2Switch"==t.id?$("#auxname2").text():"thSwitch"==t.id?"thermocontrol":""}`,message:`Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian<br>Status Error : ${n}`,closeButton:!1,buttons:{ok:{label:"Tutup"}}})})};"coolerSwitch"==this.id||"heaterSwitch"==this.id?"auto"===$("input[name='operation']:checked").val()?($(this).prop("checked",!e),bootbox.alert({size:"large",title:"Aksi tidak dapat dilakukan",message:"Mengubah keadaan pemanas atau pendingin dengan saklar hanya dapat dilakukan saat mode manual",closeButton:!1,buttons:{ok:{label:"Tutup"}}})):t(this):(t(this),"thSwitch"==this.id&&e?$("#thOverlay").removeClass("active"):"thSwitch"!=this.id||e||$("#thOverlay").addClass("active"))}),$("#addCond").unbind().removeData(),$("#addCond").click(function(){for(var a,e=!0,t=1;t<=30;t++){if(0==$("#condition"+t).length){a=t;break}30==t&&(e=!1)}e?(appendConditionalChild(a,["Nilai Suhu","Nilai Humiditas","Jadwal Harian","Tanggal Waktu","Keadaan"]),$("html, body").animate({scrollTop:$(`#condition${a}`).offset().top-$("#conditional").offset().top+$("#conditional").scrollTop()-60},500)):bootbox.alert({size:"large",title:"Tidak dapat menambah program",message:"Jumlah maksimum program yang dapat ditambahkan adalah 30",closeButton:!1,buttons:{ok:{label:"Tutup"}}})}),$("input[name='thermmode'],input[name='operation'],input[name='cmode'],input[name='hmode']").unbind().removeData(),$("input[name='thermmode'],input[name='operation'],input[name='cmode'],input[name='hmode']").click(function(){modeCallback(this.value,this.name,!("cmode"==this.name||"hmode"==this.name))}),$('[data-toggle="popover"]').popover({html:!0})}var prevInput={};$(document).ready(function(){nexusFirstLoad(),$("#content").on("click","#deviceSetting",function(){$(".absolute-overlay").removeClass("loaded"),$("#content").html(""),$("#content").load("pagecon/nexus-settings.php",function(a,e,t){"success"==e&&($(".absolute-overlay").addClass("loaded"),nexusSettingLoad()),"error"==status&&bootbox.alert({size:"large",title:"Gagal memuat laman",message:"Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian",closeButton:!1,buttons:{ok:{label:"Tutup"}}})})}),$("#content").on("click","#deviceHome",function(){$(".absolute-overlay").removeClass("loaded"),$("#content").html(""),$("#content").load("pagecon/nexus-device.php",function(a,e,t){"success"==e&&(nexusFirstLoad(getBondKey()),$(".absolute-overlay").addClass("loaded")),"error"==status&&bootbox.alert({size:"large",title:"Gagal memuat laman",message:"Sepertinya server terlalu lama merespons, ini dapat disebabkan oleh koneksi yang buruk atau error pada server kami. Mohon coba lagi sesaat kemudian",closeButton:!1,buttons:{ok:{label:"Tutup"}}})})}),setTimeout(function a(){""!=getBondKey()&&$("#nexus-dashboard").length&&reloadStatus(),setTimeout(a,3e3)},3e3)});const a=setInterval(function(){""!=getBondKey()&&($(".absolute-overlay").addClass("loaded"),clearInterval(a))},100)}}